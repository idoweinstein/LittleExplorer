<!DOCTYPE html>
<html>
<head>
   {% load static %}
    <link rel="stylesheet" href="{% static 'base.css' %}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://unpkg.com/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js" integrity="sha384-Y4oOpwW3duJdCWv5ly8SCFYWqFDsfob/3GkgExXKV4idmbt98QcxXYs9UoXAB7BZ" crossorigin="anonymous"></script> 
    <script>
        $(document).ready(function() {
            $("#search-button").click(function() {
                var userEmail = $("#search-input").val();
                var csrftoken = $("[name=csrfmiddlewaretoken]").val();
                $.ajax({
                    url: "/add-connection/",
                    type: "POST",
                    data: {
                        user_email: userEmail
                    },
                    beforeSend: function(xhr) {
                        xhr.setRequestHeader("X-CSRFToken", csrftoken);
                    },
                    success: function(response) {
                        // Handle the response from the Django endpoint
                        console.log(response);
                        alert(response.message);
                    },
                    error: function(xhr) {
                        // Handle error
                        var response = JSON.parse(xhr.responseText);
                        var errorMessage = response.message;
                        alert(errorMessage);
                    }
                });
                $("#search-input").val("");
            });
        });
    </script>
    <nav class="navbar navbar-left navbar-light justify-content-between" style="background-color: #c9f0c9;">
        <a class="navbar-brand" href="/">
            <img src="{% static 'imges/logo_img3.svg' %}" width="35" height="35" class="d-inline-block align-top" alt="">
            LittleExplorer
        </a>
        <form class="navbar-form" onsubmit="return false">
            {% if user.is_authenticated %}
            Welcome {{ user.first_name }} {{ user.last_name }}
            
            {% if user.is_teacher %}
            <button type="button" class="btn btn-outline-dark btn-sm" type="submit" onclick="location.href = '/add_kindergarten'"><span class="glyphicon glyphicon-log-out"></span>New kindergarten</button>
            {% endif %}
            <button type="button" class="btn btn-outline-dark  btn-sm" type="submit" onclick="location.href = '/logout'"><span class="glyphicon glyphicon-log-out"></span>Log out</button> 

          {% if user.is_parent %}
          <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
          <input type="text" id="search-input" placeholder="Enter user's email">
          <button id="search-button">Add Connection</button>
          {% endif %}

          {% else %}
          <button type="button" class="btn btn-outline-dark  btn-sm" class="glyphicon glyphicon-user" type="submit" onclick="location.href = '/parent_sign_up'">
              <span class="glyphicon glyphicon-user"></span>Register as a parent</button>
          <button type="button" class="btn btn-outline-dark  btn-sm" class="glyphicon glyphicon-user" type="submit" onclick="location.href = '/teacher_sign_up'">
              <span class="glyphicon glyphicon-user"></span>Register as a teacher</button>
          <button type="button" class="btn btn-outline-dark btn-sm" type="submit" onclick="location.href = '/login'">
              <span class="glyphicon glyphicon-log-in"></span>Login</button>
          {% endif %}
      </form>
      <div class="dropdown">
        <button class="btn btn-outline-dark dropdown-toggle" type="button" id="signupDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Add Connection
        </button>
        <div class="dropdown-menu" aria-labelledby="signupDropdown">
          <form class="px-4 py-3">
            <div class="form-group">
              <label for="name">Name</label>
              <input type="text" class="form-control" id="name" placeholder="Enter your name">
            </div>
            <div class="form-group">
              <label for="email">Email address</label>
              <input type="email" class="form-control" id="email" placeholder="Enter your email">
            </div>
            <div class="form-group">
              <label for="password">Password</label>
              <input type="password" class="form-control" id="password" placeholder="Enter your password">
            </div>
            <button type="submit" class="btn btn-primary">Sign Up</button>
          </form>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#">Already have an account? Sign in</a>
        </div>
      </div>
  </nav>
</head>
<body style="background-color: #c9ccca;">
    {% block content %}{% endblock %}
</body>
</html>